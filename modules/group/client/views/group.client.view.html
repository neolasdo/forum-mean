<section ng-controller="GroupController as vm" class="main">
  <div class="row">
    <div class="col-sm-3">
      <div class="panel panel-default">
        <div class="panel-body" style="padding: 10px 5px">
          <div class="row">
            <div class="col-xs-4">
              <img ng-src="{{vm.auth.user.profileImageURL?vm.auth.user.profileImageURL:'/modules/users/client/img/profile/default.png'}}" class="img-thumbnail" alt="{{vm.auth.user.displayName}}" width="100%" style="width: 100%; max-height:230px">
            </div>
            <div class="info col-xs-8">
              <p style="font-size: 17px"><a href="/settings/profile">Hi, {{vm.auth.user.displayName}}</a></p>
              <p>{{vm.auth.user.roles === 'student'? 'Học viên': 'Giáo viên'}}</p>
            </div>
          </div>
        </div>
      </div>
      <div class="panel panel-info">
        <div class="panel-heading">
          <h3 style="font-size: 19px; margin: 0">{{vm.groupInfo.groupName}} <button ng-if="vm.groupInfo.createdBy == vm.auth.user._id" style="border: 0; background: none" ui-sref="group.setting" class="pull-right"><span class="fas fa-pencil-alt"></span></button></h3>
        </div>
        <div class="panel-body" style="overflow: hidden">
          <div class="form-group text-center" style="border: 1px solid #ddd;padding: 5px">
            <img ng-src="{{vm.groupInfo.image?vm.groupInfo.image:'modules/group/client/img/profile/default.png'}}" alt="Class Logo" class="img-thumbnail" style="border: none;max-height: 250px; min-height:150px">
          </div>
          <div class="info">
            <p class="text-left">Code: <span style="color: #000; font-size: 1em;">{{vm.groupInfo.secretCode}}</span>
              <button ng-if="vm.groupInfo.createdBy._id == vm.auth.user._id" style="border: 0; background: none" ng-click="vm.resetCode()" class="pull-right"><span class="fas fa-history"></span></button>
            </p>
            <div class="nav-tabs">
              <div class="list-heading" ui-sref="group.home">
                  Trang chủ
                <span class="pull-right"><i class="fa fa-angle-right"></i></span>
              </div>
            </div>
            <div class="nav-tabs">
              <div class="list-heading" ui-sref="group.students">
                  Thành viên
                <span class="pull-right"><i class="fa fa-angle-right"></i></span>
              </div>
            </div>
            <div class="nav-tabs">
              <div ng-if="vm.groupInfo.createdBy._id == vm.auth.user._id" class="list-heading" ui-sref="group.assigments">
                Bài khảo sát
                <span class="pull-right"><i class="fa fa-angle-right"></i></span>
              </div>
            </div>
            <div class="nav-tabs">
              <div class="list-heading" ui-sref="group.documents">
                Tài liệu
                <span class="pull-right"><i class="fa fa-angle-right"></i></span>
              </div>
            </div>
            <div class="nav-tabs">
              <div class="list-heading" ui-sref="group.videos">
                Bài giảng video
                <span class="pull-right"><i class="fa fa-angle-right"></i></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-sm-6 col-md-6">
      <div ui-view></div>
    </div>
    <div class="col-sm-3">
        <div class="panel panel-success">
        <div class="panel-body statics">
          <ul style="padding: 0">
            <li>
              <p class="statics-count"><i class="fa fa-question-circle"></i> <span ng-bind="vm.count.topics"></span></p>
              <p>Bài viết</p>
            </li>
            <li>
              <p class="statics-count"><i class="fa fa-comments"></i> <span ng-bind="vm.count.comments"></span></p>
              <p>Bình luận</p>
            </li>
            <li>
              <p class="statics-count"><i class="fa fa-file"></i> <span ng-bind="vm.count.assignments"></span></p>
              <p>Assigment</p>
            </li>
            <li>
              <p class="statics-count"><i class="fa fa-user"></i> <span ng-bind="vm.count.students"></span></p>
              <p>Học viên</p>
            </li>
          </ul>
        </div>
      </div>
        <div class="panel panel-success">
            <div class="panel-heading">
                <h3 class="panel-title">Giáo viên đang dạy trực tuyến!</h3>
            </div>
            <div class="panel-body row">
                <div class="col-sm-12" style="padding-bottom: 20px">
                    Bài giảng về HTML5 - CSS3
                </div>
                <div class="col-sm-12 text-right">
                    <button class="btn btn-info btn-sm" ng-click="vm.openStream()"><span class="fa fa-play"></span> Xem ngay!</button>
                </div>
            </div>
        </div>
        <div class="panel panel-danger">
            <div class="panel-heading">
                <h3 class="panel-title">Bạn có {{vm.assignments.length}} khảo sát cần hoàn thành</h3>
            </div>
            <div class="panel-body">
                <div class="assignment-list">
                    <div class="assignment row"  ng-repeat="assignment in vm.assignments">
                        <div class="col-sm-12">
                            <h4 class="assig-name"><b>{{assignment.name}}</b></h4>
                            <p class="assig-time">{{assignment.startDate|date:'dd/MM/yyyy'}} - {{assignment.endDate|date:'dd/MM/yyyy'}}</p>
                            <p class="assig-title" ta-bind ng-model="assignment.title"></p>
                        </div>
                        <div class="col-sm-12 text-right">
                            <button class="btn btn-success btn-sm" ng-if="!assignment.answer" ng-click="vm.finishAssignment(assignment)"><span class="fa fa-check-square"></span> Hoàn thành</button>
                            <button class="btn btn-info btn-sm" ng-if="assignment.answer" ng-click="vm.getUserAnswer(assignment)"><span class="fa fa-check-square"></span> Xem lại</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-1 hidden-sm">

    </div>
  </div>
</section>


<script type="text/ng-template" id="stream-modal.html">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="vm.close()"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Học online</h4>
    </div>
    <div class="modal-body">
        <div class="row" style="padding: 20px">

        </div>
    </div>
    <div class="modal-footer text-right">
        <button class="btn btn-default" ng-click="vm.close()">Đóng</button>
    </div>
</script>
<script type="text/ng-template" id="finish-assignment.html">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="vm.close()"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Hoàn thành khảo sát</h4>
    </div>
    <div class="modal-body">
        <div class="row" style="padding: 10px 20px">
            <div class="col-sm-4">
                <h2 class="assig-name">{{vm.assignment.name}}</h2>
            </div>
            <div class="col-sm-8">
                <p><b>Hạn nộp:</b> Trước ngày: {{vm.assignment.endDate|date: 'dd/MM/yyyy'}}</p>
                <p><b>Nội dung:</b> <span ta-bind ng-model="vm.assignment.title"></span></p>
            </div>
        </div>
        <div class="row" style="padding: 10px 20px">
            <div class="col-sm-12" ng-repeat="(index,question) in vm.assignment.questions">
                <quiz value="question" quiz-model="vm.studentAnswer.answers[index]"></quiz>
            </div>
        </div>
    </div>
    <div class="modal-footer text-right">
        <button class="btn btn-success" ng-click="vm.save()">Xong</button>
        <button class="btn btn-default" ng-click="vm.close()">Đóng</button>
    </div>
</script>
<script type="text/ng-template" id="view-assignment.html">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="vm.close()"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Xem lại</h4>
    </div>
    <div class="modal-body">
        <div class="row" style="padding: 10px 20px">
            <div class="col-sm-4">
                <h2 class="assig-name">{{vm.assignment.name}}</h2>
            </div>
            <div class="col-sm-8">
                <p><b>Hạn nộp:</b> Trước ngày: {{vm.assignment.endDate|date: 'dd/MM/yyyy'}}</p>
                <p><b>Nội dung:</b> <span ta-bind ng-model="vm.assignment.title"></span></p>
            </div>
        </div>
        <div class="row" style="padding: 10px 20px">
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Câu hỏi</th>
                            <th>Câu trả lời</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="answer in vm.assignment.answer.answer">
                            <td>{{answer.question}}</td>
                            <td ta-bind ng-model="answer.answer"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="modal-footer text-right">
        <button class="btn btn-default" ng-click="vm.close()">Đóng</button>
    </div>
</script>